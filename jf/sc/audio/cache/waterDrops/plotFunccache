{|env|varslices=env[\slices];varaudio=env[\audio];{|key|fork{vartree=FluidKDTree(s);tree.fit(env[key]);s.sync;env[key].dump({|dict|varxybuf=Buffer.alloc(s,2);defer{FluidPlotter(dict:dict,mouseMoveAction:{|view,x,y|[x,y].postln;xybuf.setn(0,[x,y]);tree.kNearest(xybuf,1,{|id|varindex=id.asInteger;defer{view.highlight_(id)};{varstart=Index.kr(slices,index);varend=Index.kr(slices,index+1);varsig=PlayBuf.ar(1,audio,BufRateScale.ir(audio),1,start);vardur_sec=min((end-start)/SampleRate.ir,1);varenv=EnvGen.kr(Env([0,1,1,0],[0.01,dur_sec-0.02,0.01].abs),doneAction:2);varp=Pan2.ar(sig,2.0.rand-1);p*env;}.play;});});};//defer})}}}